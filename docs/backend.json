{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the Artify AI application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user entity."
        },
        "email": {
          "type": "string",
          "description": "Email address of the user.",
          "format": "email"
        }
      },
      "required": [
        "id",
        "email"
      ]
    },
    "Prompt": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Prompt",
      "type": "object",
      "description": "Represents a generated prompt stored in the system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the prompt entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to the User who generated this prompt. (Relationship: User 1:N Prompt)"
        },
        "promptText": {
          "type": "string",
          "description": "The text content of the generated prompt."
        },
        "niche": {
          "type": "string",
          "description": "The niche or theme used to generate the prompt."
        },
        "creationDate": {
          "type": "string",
          "description": "Date and time when the prompt was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "promptText",
        "niche",
        "creationDate"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profile data. Path-based ownership, ensuring only the authenticated user can access their profile.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user.  Corresponds to `request.auth.uid`."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/prompts/{promptId}",
        "definition": {
          "entityName": "Prompt",
          "schema": {
            "$ref": "#/backend/entities/Prompt"
          },
          "description": "Stores prompts generated by a specific user. Path-based ownership allows straightforward security rules ensuring only the user can access their prompts.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user who created the prompt.  Corresponds to `request.auth.uid`."
            },
            {
              "name": "promptId",
              "description": "The unique identifier of the prompt."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to ensure secure access and efficient data management for the Artify AI application. The core principle is Authorization Independence, achieved through path-based ownership for user-generated prompts. This eliminates the need for complex `get()` calls in security rules, making them simpler and more robust.  The structure uses hierarchical paths for user-owned data (Prompts), following the pattern `/users/{userId}/prompts/{promptId}`. This clearly defines ownership and enables straightforward security rules based on the user's ID.  This structure directly supports the QAPs by segregating user data, providing clear ownership, and enabling secure list operations within each user's prompt collection."
  }
}